rules_version = '2';

service cloud.firestore {
  match /databases/(default)/documents {

    // WARNING: TEMPORARY DIAGNOSTIC RULES - HIGHLY INSECURE
    // These rules allow anyone to read and write to your entire (default) database.
    // Use ONLY for debugging the "client is offline" issue.
    // REVERT TO SECURE RULES IMMEDIATELY AFTER DIAGNOSIS.
    match /{document=**} {
      allow read, write: if true;
    }

    /*
    // PREVIOUS SECURE RULES (Commented out for diagnostics)
    // Rules for the authentication users collection
    match /auth_users/{userEmail} {
      allow get: if true; // Allows client to read specific user profile for approval status
      allow list, create, update, delete: if false; // Other ops by server actions
    }

    // Rules for the user-specific product data
    // Path: user_products/{loggedInUserEmail}/uploaded_products/{productIdOrMetadata}
    match /user_products/{userEmail}/uploaded_products/{documentId} {
      // PERMISSIVE FOR PROTOTYPE - Client needs to know userEmail.
      // For production, all writes should be via server actions.
      allow read, write, delete: if true;
    }

    // Fallback rule: Deny access to any other paths not defined above.
    match /{path=**} {
      allow read, write: if false;
    }
    */
  }
}
