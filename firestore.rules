rules_version = '2';

service cloud.firestore {
  match /databases/ecom/documents { // Certifique-se que 'ecom' é o ID do seu banco de dados no Firebase.

    // Permite que um usuário autenticado leia e escreva (crie, atualize, exclua)
    // QUALQUER documento ou subcoleção sob seu próprio caminho /users/{userId}.
    // Isso cobre /users/{userId}/products/* e /users/{userId}/products/_metadata
    match /users/{userId}/{subpath=**} { // {subpath=**} é um curinga recursivo
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Adicione aqui regras para outras coleções de nível raiz, se necessário.
    // Se não houver outras regras, o acesso a outras coleções será negado por padrão.
  }
}
